<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rutinkoo — Command Center</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0b0e14;
            --card: #151921;
            --inner: #1e232d;
            --accent: #8b5cf6; /* Electric Violet */
            --accent-dim: #4c1d95;
            --text-p: #ffffff;
            --text-s: #94a3b8;
            --border: #2d333f;
        }

        * { box-sizing: border-box; transition: all 0.2s ease-in-out; }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--bg);
            color: var(--text-p);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
        }

        /* --- RESPONSIVE GRID LAYOUT --- */
        .app-container {
            width: 100%;
            max-width: 1400px;
            display: grid;
            grid-template-columns: 1fr; /* Mobile default */
            gap: 20px;
        }

        @media (min-width: 768px) { /* Tablet/iPad */
            .app-container { grid-template-columns: 1fr 1fr; }
            .header-full { grid-column: span 2; }
            .history-section { grid-column: span 2; }
        }

        @media (min-width: 1100px) { /* Desktop */
            .app-container { grid-template-columns: 350px 1fr 400px; }
            .header-full { grid-column: span 3; }
            .history-section { grid-column: span 1; }
        }

        /* --- COMPONENTS --- */
        .header-full {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
        }

        .logo { font-size: 1.8rem; font-weight: 800; color: var(--accent); letter-spacing: -1px; }

        .card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 24px;
            padding: 24px;
            height: fit-content;
        }

        h2 { margin: 0 0 20px 0; font-size: 1.1rem; font-weight: 600; color: var(--text-p); display: flex; align-items: center; gap: 10px; }
        h2 span { font-size: 0.8rem; color: var(--text-s); font-weight: 400; }

        /* --- CALENDAR --- */
        .cal-nav { display: flex; justify-content: space-between; margin-bottom: 20px; align-items: center; }
        .nav-btn { background: var(--inner); border: 1px solid var(--border); color: white; border-radius: 8px; cursor: pointer; padding: 5px 12px; }
        
        .grid-7 { display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px; }
        .grid-7 div { text-align: center; font-size: 0.7rem; color: var(--text-s); font-weight: 600; }

        .day {
            aspect-ratio: 1;
            background: var(--inner);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            cursor: pointer;
            border: 1px solid transparent;
        }
        .day.has-content { background: var(--accent-dim); color: var(--accent); border-color: var(--accent); }
        .day.selected { border: 2px solid white; transform: scale(1.05); }
        .day.today { text-decoration: underline; font-weight: 800; }

        /* --- HABITS & NOTES --- */
        .input-group { background: var(--inner); border-radius: 12px; padding: 15px; margin-bottom: 15px; }
        textarea {
            width: 100%; background: transparent; border: none; color: white; font-family: inherit; resize: none; outline: none; height: 80px;
        }
        .habit-row { display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px; }
        .checkbox { width: 18px; height: 18px; accent-color: var(--accent); cursor: pointer; }
        
        .add-habit { display: flex; gap: 8px; margin-top: 15px; }
        .add-habit input { flex: 1; background: var(--inner); border: 1px solid var(--border); border-radius: 8px; padding: 10px; color: white; }
        .add-habit button { background: var(--accent); border: none; padding: 0 15px; border-radius: 8px; font-weight: 700; cursor: pointer; }

        /* --- SUMMARY TIMELINE --- */
        .filter-tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab { 
            flex: 1; padding: 8px; border-radius: 8px; border: 1px solid var(--border); background: var(--inner); color: var(--text-s); cursor: pointer; font-size: 0.8rem; text-align: center;
        }
        .tab.active { background: var(--accent); color: white; border-color: var(--accent); }

        .timeline { max-height: 600px; overflow-y: auto; padding-right: 5px; }
        .timeline-item { 
            border-left: 2px solid var(--accent-dim); padding-left: 15px; margin-bottom: 25px; position: relative;
        }
        .timeline-item::before {
            content: ''; position: absolute; left: -6px; top: 0; width: 10px; height: 10px; background: var(--accent); border-radius: 50%;
        }
        .tl-date { font-size: 0.8rem; color: var(--accent); font-weight: 700; margin-bottom: 5px; }
        .tl-content { font-size: 0.9rem; color: var(--text-p); margin-bottom: 5px; line-height: 1.4; }
        .tl-stats { font-size: 0.75rem; color: var(--text-s); }

        /* Custom Scrollbar */
        .timeline::-webkit-scrollbar { width: 4px; }
        .timeline::-webkit-scrollbar-thumb { background: var(--border); border-radius: 10px; }
    </style>
</head>
<body>

    <div class="app-container">
        
        <header class="header-full">
            <div class="logo">Rutinkoo.</div>
            <div id="live-clock" style="color: var(--text-s); font-size: 0.9rem;"></div>
        </header>

        <!-- COLUMN 1: TRACKER -->
        <div class="card">
            <h2 id="focus-date-label">Today <span>Jan 14, 2026</span></h2>
            
            <div class="input-group">
                <textarea id="day-note" placeholder="What happened today?" oninput="saveDataState()"></textarea>
            </div>

            <div id="habit-checklist">
                <!-- Habits here -->
            </div>

            <div class="add-habit">
                <input type="text" id="new-habit-input" placeholder="New habit...">
                <button onclick="addHabit()">+</button>
            </div>
        </div>

        <!-- COLUMN 2: CALENDAR -->
        <div class="card">
            <div class="cal-nav">
                <button class="nav-btn" onclick="adjustMonth(-1)">‹</button>
                <div id="month-label" style="font-weight: 700;">January 2026</div>
                <button class="nav-btn" onclick="adjustMonth(1)">›</button>
            </div>
            
            <div class="grid-7" style="margin-bottom: 10px;">
                <div>MO</div><div>TU</div><div>WE</div><div>TH</div><div>FR</div><div>SA</div><div>SU</div>
            </div>
            <div class="grid-7" id="calendar-grid"></div>
        </div>

        <!-- COLUMN 3: SUMMARY TIMELINE -->
        <div class="card history-section">
            <h2>Summary <span>Past Insights</span></h2>
            <div class="filter-tabs">
                <div class="tab active" onclick="setTimelineFilter('week', this)">This Week</div>
                <div class="tab" onclick="setTimelineFilter('month', this)">This Month</div>
            </div>
            
            <div class="timeline" id="timeline-container">
                <!-- Timeline items here -->
            </div>
        </div>

    </div>

    <script>
        let habits = JSON.parse(localStorage.getItem('rtk_h')) || ['Workout', 'Read 20m', 'Code'];
        let trackerData = JSON.parse(localStorage.getItem('rtk_d')) || {};
        let focusedDate = new Date();
        let calContext = new Date();
        let timelineFilter = 'week';

        function saveDataState() {
            const dk = getDK(focusedDate);
            if(!trackerData[dk]) trackerData[dk] = { note: '', habits: {} };
            trackerData[dk].note = document.getElementById('day-note').value;
            
            localStorage.setItem('rtk_h', JSON.stringify(habits));
            localStorage.setItem('rtk_d', JSON.stringify(trackerData));
            renderCalendar();
            renderTimeline();
        }

        function getDK(date) { return date.toISOString().split('T')[0]; }

        // --- CALENDAR ---
        function renderCalendar() {
            const grid = document.getElementById('calendar-grid');
            grid.innerHTML = '';
            const m = calContext.getMonth();
            const y = calContext.getFullYear();
            
            document.getElementById('month-label').textContent = calContext.toLocaleString('default', { month: 'long', year: 'numeric' });

            const firstDay = new Date(y, m, 1).getDay();
            const daysInMonth = new Date(y, m + 1, 0).getDate();
            const padding = firstDay === 0 ? 6 : firstDay - 1;

            for (let i = 0; i < padding; i++) grid.appendChild(document.createElement('div'));

            for (let d = 1; d <= daysInMonth; d++) {
                const date = new Date(y, m, d);
                const dk = getDK(date);
                const el = document.createElement('div');
                el.className = 'day';
                el.textContent = d;

                const hasNote = trackerData[dk]?.note?.length > 0;
                const habitsDone = Object.values(trackerData[dk]?.habits || {}).filter(v => v).length;
                
                if(hasNote || habitsDone > 0) el.classList.add('has-content');
                if(dk === getDK(new Date())) el.classList.add('today');
                if(dk === getDK(focusedDate)) el.classList.add('selected');

                el.onclick = () => { focusedDate = date; renderFocusDay(); renderCalendar(); };
                grid.appendChild(el);
            }
        }

        // --- TRACKER FOCUS ---
        function renderFocusDay() {
            const dk = getDK(focusedDate);
            document.getElementById('focus-date-label').innerHTML = 
                `${focusedDate.toLocaleDateString(undefined, {weekday:'long'})} <span>${focusedDate.toLocaleDateString(undefined, {month:'short', day:'numeric', year:'numeric'})}</span>`;
            
            document.getElementById('day-note').value = trackerData[dk]?.note || '';
            
            const list = document.getElementById('habit-checklist');
            list.innerHTML = '';
            habits.forEach(h => {
                const checked = trackerData[dk]?.habits?.[h] ? 'checked' : '';
                const item = document.createElement('div');
                item.className = 'habit-row';
                item.innerHTML = `
                    <span>${h}</span>
                    <input type="checkbox" class="checkbox" ${checked} onchange="toggleH('${h}')">
                `;
                list.appendChild(item);
            });
        }

        function toggleH(h) {
            const dk = getDK(focusedDate);
            if(!trackerData[dk]) trackerData[dk] = { note: '', habits: {} };
            if(!trackerData[dk].habits) trackerData[dk].habits = {};
            trackerData[dk].habits[h] = !trackerData[dk].habits[h];
            saveDataState();
        }

        function addHabit() {
            const input = document.getElementById('new-habit-input');
            const val = input.value.trim();
            if(val) { habits.push(val); input.value = ''; saveDataState(); renderFocusDay(); }
        }

        // --- TIMELINE / SUMMARY ---
        function setTimelineFilter(type, el) {
            timelineFilter = type;
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            el.classList.add('active');
            renderTimeline();
        }

        function renderTimeline() {
            const container = document.getElementById('timeline-container');
            container.innerHTML = '';
            
            const daysToScroll = timelineFilter === 'week' ? 7 : 30;
            const today = new Date();

            for(let i=0; i < daysToScroll; i++) {
                const d = new Date();
                d.setDate(today.getDate() - i);
                const dk = getDK(d);
                const data = trackerData[dk];

                if(data && (data.note || Object.values(data.habits || {}).some(v => v))) {
                    const habitsDone = Object.values(data.habits || {}).filter(v => v).length;
                    const item = document.createElement('div');
                    item.className = 'timeline-item';
                    item.innerHTML = `
                        <div class="tl-date">${d.toLocaleDateString(undefined, {month:'short', day:'numeric'})}</div>
                        <div class="tl-content">${data.note || '<i>No written reflection</i>'}</div>
                        <div class="tl-stats">✦ ${habitsDone}/${habits.length} habits fulfilled</div>
                    `;
                    container.appendChild(item);
                }
            }
            if(container.innerHTML === '') container.innerHTML = '<div style="color:var(--text-s); font-size:0.8rem;">No activity recorded for this period.</div>';
        }

        function adjustMonth(o) { calContext.setMonth(calContext.getMonth() + o); renderCalendar(); }

        // Clock
        setInterval(() => {
            const now = new Date();
            document.getElementById('live-clock').textContent = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        }, 1000);

        // Init
        renderCalendar();
        renderFocusDay();
        renderTimeline();
    </script>
</body>
</html>
