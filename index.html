<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rutinkoo — Soft Habit Tracking</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;500;700&family=Nunito:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #1a1b26;
            --surface: #24283b;
            --accent-purple: #bb9af7;
            --accent-teal: #73daca;
            --accent-pink: #f7768e;
            --text-main: #cfc9c2;
            --text-dim: #565f89;
            --border-radius: 24px;
            --soft-shadow: 6px 6px 0px #16161e;
            --inner-shadow: inset 2px 2px 5px rgba(255,255,255,0.05);
        }

        * { box-sizing: border-box; transition: all 0.3s ease; }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        /* --- NAVIGATION DOCK --- */
        nav {
            background: var(--surface);
            padding: 10px;
            border-radius: 50px;
            display: flex;
            gap: 10px;
            box-shadow: var(--soft-shadow);
            margin-bottom: 40px;
            position: sticky;
            top: 20px;
            z-index: 100;
            border: 2px solid #16161e;
        }

        .nav-btn {
            padding: 12px 24px;
            border-radius: 40px;
            cursor: pointer;
            font-family: 'Fredoka', sans-serif;
            font-weight: 500;
            color: var(--text-dim);
            border: none;
            background: transparent;
        }

        .nav-btn.active {
            background: var(--accent-purple);
            color: var(--bg);
        }

        /* --- HEADER --- */
        header {
            text-align: center;
            margin-bottom: 40px;
        }

        .logo {
            font-family: 'Fredoka', sans-serif;
            font-size: 3.5rem;
            margin: 0;
            color: var(--accent-teal);
            letter-spacing: -1px;
        }

        #live-clock {
            font-size: 1.1rem;
            color: var(--text-dim);
            margin-top: 10px;
        }

        /* --- PAGES --- */
        .page { display: none; width: 100%; max-width: 1000px; animation: fadeIn 0.5s ease; }
        .page.active { display: block; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- CARDS & PANELS --- */
        .glass-panel {
            background: var(--surface);
            border-radius: var(--border-radius);
            padding: 30px;
            box-shadow: var(--soft-shadow);
            border: 2px solid #16161e;
            margin-bottom: 20px;
        }

        /* --- TRACKER TABLE --- */
        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        button, select, input {
            background: var(--bg);
            border: 2px solid #16161e;
            color: var(--text-main);
            padding: 12px 20px;
            border-radius: 15px;
            font-family: 'Fredoka', sans-serif;
            outline: none;
        }

        button {
            cursor: pointer;
            background: var(--surface);
            box-shadow: 4px 4px 0px #16161e;
        }

        button:active {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0px #16161e;
        }

        table { width: 100%; border-collapse: separate; border-spacing: 0 10px; }
        th { color: var(--text-dim); font-weight: 500; padding: 10px; text-align: center; }
        td { background: #2a2f41; padding: 15px; text-align: center; border-top: 1px solid #333; border-bottom: 1px solid #333;}
        td:first-child { border-radius: 15px 0 0 15px; border-left: 1px solid #333; }
        td:last-child { border-radius: 0 15px 15px 0; border-right: 1px solid #333; }

        /* Custom Checkbox */
        .habit-check {
            appearance: none;
            width: 28px;
            height: 28px;
            background: var(--bg);
            border-radius: 8px;
            cursor: pointer;
            position: relative;
        }

        .habit-check:checked {
            background: var(--accent-teal);
        }

        .habit-check:checked::after {
            content: '✓';
            color: var(--bg);
            position: absolute;
            left: 50%; top: 50%;
            transform: translate(-50%, -50%);
            font-weight: bold;
        }

        /* --- DASHBOARD --- */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .stat-card {
            background: var(--bg);
            padding: 25px;
            border-radius: var(--border-radius);
            text-align: center;
            border: 2px solid #16161e;
        }

        .stat-card h3 { font-family: 'Fredoka', sans-serif; color: var(--accent-purple); margin-top: 0; }
        
        .progress-ring {
            width: 120px; height: 120px;
            border-radius: 50%;
            margin: 20px auto;
            display: flex; align-items: center; justify-content: center;
            background: radial-gradient(closest-side, var(--bg) 80%, transparent 0 100%),
                        conic-gradient(var(--accent-teal) var(--p), #333 0);
            font-weight: bold;
            font-size: 1.2rem;
        }

        /* --- NOTES --- */
        .note-row {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 20px;
            background: #2a2f41;
            margin-bottom: 15px;
            border-radius: 15px;
        }
        .note-date { font-family: 'Fredoka', sans-serif; color: var(--accent-pink); width: 140px; }
        .note-input { flex-grow: 1; background: transparent; border: none; border-bottom: 1px solid var(--text-dim); border-radius: 0; padding: 5px; }

    </style>
</head>
<body>

    <header>
        <h1 class="logo">Rutinkoo</h1>
        <div id="live-clock">Loading calm vibes...</div>
    </header>

    <nav>
        <button class="nav-btn active" onclick="showPage('log')">Tracker</button>
        <button class="nav-btn" onclick="showPage('dashboard')">Analytics</button>
        <button class="nav-btn" onclick="showPage('notes')">Notebook</button>
    </nav>

    <!-- PAGE: TRACKER -->
    <div id="log" class="page active">
        <div class="glass-panel">
            <div class="controls">
                <button onclick="changeDate(-1)">←</button>
                <span id="date-label" style="font-family: 'Fredoka'; padding-top: 10px; min-width: 120px; text-align: center;"></span>
                <button onclick="changeDate(1)">→</button>
                <select id="view-select" onchange="renderTable()">
                    <option value="week">Weekly View</option>
                    <option value="month">Monthly View</option>
                </select>
                <input type="text" id="new-habit-name" placeholder="Add a soft goal...">
                <button onclick="addHabit()" style="background: var(--accent-teal); color: var(--bg);">Add</button>
            </div>
            <table>
                <thead><tr id="header-row"></tr></thead>
                <tbody id="table-body"></tbody>
            </table>
        </div>
    </div>

    <!-- PAGE: DASHBOARD -->
    <div id="dashboard" class="page">
        <div class="glass-panel">
            <h2 style="font-family: 'Fredoka';">Your Growth</h2>
            <div id="timeframe-buttons" style="margin-bottom: 20px;">
                <button onclick="renderDashboard('week')">This Week</button>
                <button onclick="renderDashboard('month')">This Month</button>
                <button onclick="renderDashboard('year')">This Year</button>
            </div>
            <div class="stats-grid" id="stats-container"></div>
        </div>
    </div>

    <!-- PAGE: NOTES -->
    <div id="notes" class="page">
        <div class="glass-panel">
            <h2 style="font-family: 'Fredoka';">Daily Notebook</h2>
            <p style="color: var(--text-dim);">Reflect on your small wins...</p>
            <div id="notes-list"></div>
        </div>
    </div>

    <script>
        let habits = JSON.parse(localStorage.getItem('rutinkoo_habits')) || ['Morning Yoga', 'Read', 'Drink Water'];
        let trackerData = JSON.parse(localStorage.getItem('rutinkoo_data')) || {};
        let currentDate = new Date();

        function saveData() {
            localStorage.setItem('rutinkoo_habits', JSON.stringify(habits));
            localStorage.setItem('rutinkoo_data', JSON.stringify(trackerData));
        }

        // --- CLOCK ---
        function updateClock() {
            const now = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('live-clock').textContent = now.toLocaleDateString(undefined, options) + " | " + now.toLocaleTimeString();
        }
        setInterval(updateClock, 1000);
        updateClock();

        // --- NAVIGATION ---
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            event.target.classList.add('active');
            
            if(pageId === 'dashboard') renderDashboard('week');
            if(pageId === 'notes') renderNotesPage();
        }

        // --- TRACKER LOGIC ---
        function formatDateKey(date) { return date.toISOString().split('T')[0]; }

        function renderTable() {
            const view = document.getElementById('view-select').value;
            const start = new Date(currentDate);
            if(view === 'week') start.setDate(start.getDate() - start.getDay() + 1);
            else start.setDate(1);

            const days = view === 'week' ? 7 : new Date(start.getFullYear(), start.getMonth() + 1, 0).getDate();
            document.getElementById('date-label').textContent = view === 'week' ? `Week of ${start.getMonth()+1}/${start.getDate()}` : start.toLocaleString('default', { month: 'long' });

            const header = document.getElementById('header-row');
            header.innerHTML = '<th>Date</th>';
            habits.forEach(h => header.innerHTML += `<th>${h}</th>`);

            const body = document.getElementById('table-body');
            body.innerHTML = '';
            for(let i=0; i<days; i++){
                const d = new Date(start); d.setDate(start.getDate() + i);
                const dk = formatDateKey(d);
                const tr = document.createElement('tr');
                tr.innerHTML = `<td><span style="color:var(--text-dim)">${d.getDate()}</span> <b>${d.toLocaleDateString(undefined, {weekday:'short'})}</b></td>`;
                habits.forEach(h => {
                    const checked = trackerData[dk] && trackerData[dk][h] ? 'checked' : '';
                    const td = document.createElement('td');
                    td.innerHTML = `<input type="checkbox" class="habit-check" ${checked} onchange="toggleHabit('${dk}', '${h}')">`;
                    tr.appendChild(td);
                });
                body.appendChild(tr);
            }
        }

        function toggleHabit(dk, h) {
            if(!trackerData[dk]) trackerData[dk] = {};
            trackerData[dk][h] = !trackerData[dk][h];
            saveData();
        }

        function addHabit() {
            const val = document.getElementById('new-habit-name').value.trim();
            if(val && !habits.includes(val)) {
                habits.push(val);
                document.getElementById('new-habit-name').value = '';
                saveData(); renderTable();
            }
        }

        function changeDate(offset) {
            const view = document.getElementById('view-select').value;
            if (view === 'week') currentDate.setDate(currentDate.getDate() + (offset * 7));
            else currentDate.setMonth(currentDate.getMonth() + offset);
            renderTable();
        }

        // --- ANALYTICS LOGIC ---
        function renderDashboard(timeframe) {
            const container = document.getElementById('stats-container');
            container.innerHTML = '';
            
            let daysToLookBack = timeframe === 'week' ? 7 : timeframe === 'month' ? 30 : 365;
            const today = new Date();

            habits.forEach(h => {
                let completed = 0;
                for(let i=0; i<daysToLookBack; i++) {
                    const d = new Date(); d.setDate(today.getDate() - i);
                    const dk = formatDateKey(d);
                    if(trackerData[dk] && trackerData[dk][h]) completed++;
                }
                const p = Math.round((completed / daysToLookBack) * 100);
                container.innerHTML += `
                    <div class="stat-card">
                        <h3>${h}</h3>
                        <div class="progress-ring" style="--p: ${p}%">${p}%</div>
                        <div style="color: var(--text-dim)">${completed} days complete</div>
                    </div>
                `;
            });
        }

        // --- NOTES LOGIC ---
        function renderNotesPage() {
            const list = document.getElementById('notes-list');
            list.innerHTML = '';
            const today = new Date();
            for(let i=0; i<10; i++) {
                const d = new Date(); d.setDate(today.getDate() - i);
                const dk = formatDateKey(d);
                const val = (trackerData[dk] && trackerData[dk].note) ? trackerData[dk].note : '';
                const row = document.createElement('div');
                row.className = 'note-row';
                row.innerHTML = `
                    <div class="note-date">${d.toLocaleDateString(undefined, {month:'short', day:'numeric', weekday:'short'})}</div>
                    <input type="text" class="note-input" value="${val}" placeholder="Write a reflection..." onchange="updateNote('${dk}', this.value)">
                `;
                list.appendChild(row);
            }
        }

        function updateNote(dk, val) {
            if(!trackerData[dk]) trackerData[dk] = {};
            trackerData[dk].note = val;
            saveData();
        }

        renderTable();
    </script>
</body>
</html>
